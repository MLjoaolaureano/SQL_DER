use exercises;
-- 1 QUAL PLANO COM MAIOR CUSTO, CONSIDERANDO O DESCONTO ?

SELECT 
    *
FROM
    PLANO
ORDER BY (PRECO - (PRECO * (DESCONTO / 100))) DESC
LIMIT 1;

-- 2 QUAL O TOTAL DE COMPRAS PARA CADA PLANO ?

SELECT 
    PLANO.ID, COUNT(*) AS COMPRAS_DO_PLANO
FROM
    PLANO
        LEFT JOIN
    CLIENTE C ON C.PLANO_ID = PLANO.ID
GROUP BY PLANO.ID;

-- 3 QUAL O CLIENTE MAIS ANTIGO ?

SELECT 
    *
FROM
    CLIENTE
ORDER BY DATA_NASCIMENTO ASC
LIMIT 1;

-- 4 QUAL A IDADE E NOME DOS CLIENTES ?

SELECT 
    (YEAR(CURRENT_TIMESTAMP) - YEAR(DATA_NASCIMENTO)) AS IDADE,
    NOME
FROM
    CLIENTE;

-- 5 ORDENE AS CIDADE COM BASE NA QUANTIDADE DE CLIENTES

SELECT 
    CIDADE, COUNT(*)
FROM
    CLIENTE
GROUP BY CIDADE
ORDER BY CIDADE DESC;

-- 6 QUAL O PLANO MAIS RÁPIDO DISPONÍVEL ?

SELECT 
    *
FROM
    PLANO
ORDER BY VELOCIDADE_MB DESC
LIMIT 1;

-- 7 QUAL A QUANTIDADE DE COMPRAS DO PLANO MAIS LENTO DISPONÍVEL ?
SELECT 
    PLANO.*, COUNT(*) AS COMPRAS_DO_PLANO
FROM
    PLANO
WHERE
    PLANO.ID = (SELECT 
            ID
        FROM
            PLANO
        ORDER BY VELOCIDADE_MB ASC
        LIMIT 1)
GROUP BY PLANO.ID;

-- 8 QUAL O PLANO DO CLIENTE MAIS ANTIGO ?

SELECT * FROM PLANO 
WHERE PLANO.ID = (SELECT PLANO_ID
FROM CLIENTE
ORDER BY DATA_NASCIMENTO ASC LIMIT 1);

-- 9 QUAL O PLANO MENOS VENDIDO ?

SELECT 
    PLANO.ID, COUNT(*) AS COMPRAS_DO_PLANO
FROM
    PLANO
        LEFT JOIN
    CLIENTE C ON C.PLANO_ID = PLANO.ID
GROUP BY PLANO.ID
ORDER BY COUNT(*) ASC
LIMIT 1;

-- 10 QUAL O PLANO COM MAIOR DESCONTO ?

SELECT 
    * 
FROM
    PLANO
ORDER BY DESCONTO DESC
LIMIT 1;



SELECT * FROM PLANO;
SELECT * FROM CLIENTE;